<html>

<head>
<title> Schembor Blog </title>
<link rel="stylesheet" href="./blog.css" type="text/css" />
</head>

<body>

<div class="banner">
<a href="http://edschembor.github.io" class="banner_link"> Main Site </a>
<a href="./index.html" class="banner_link"> Blog Home </a>
</div>


<div class="writing">
<h1> Using OpenCV to Tell If My Laundry Is Done </h1>
<p> I hate not knowing when my laudnry is done. The dryer in my house has a setting where it continues until your clothes are a certain
amount dry, as opposed to a hard time limit. Because of this, I never know when my laundry is done and end up
unnecessarily checking the machine multiple time. So, I decided to dabble in computer vision and see if I could
set up a webcam to watch the machine's dial and see if it had finished.</p>

<p> <a href="http://opencv.org/">OpenCV</a> is the opensource computer vision library which I decided to use for this project because of its Python interface and great tutorial/documentation community. Go check out the project if this is your first time hearing of it, it's really cool.</p>

<p> My first step was to get an image of the machine's dial in the completed position (see below). Once I had that, I could
compare it to the image from the webcam. Since the dial ticks were small, I added a piece of brown tape so that I could then check the color of the image in a specific area for the tape to see if the drying had finished.  </p>

<div>
<div style="float:left; margin-left:10%">
<img src="./images/done.jpg" height="300" width="300" />
<p> The dial in the done position</p>
</div>

<div style="margin-left: 700px">
<img src="./images/not_done.jpg" height="300" width="300" />
<p> The dial in the not done position</p>
</div>
</div>

<p>OpenCV has some pretty straightforward image processing methods which make detection like this relatively easy. After getting my images, I loaded them into OpenCV with: </p>

<code>  
done = cv2.imread("done.jpg")
</code>
<p></p>
<code>
not_done = cv2.imread("not_done.jpg")
</code>

<p> Then, I cropped the image as to only get the part which I wanted to focus my color detection on with the following: </p>
<code> done_tape = done.crop(500, 350, 150, 150)</code>

<p> Now, with some color manipulation, we can get the mean color of the cropped area while in the done position. We will then compare this with the mean color of our input image to see if the dryer has finished. <p>
<code> tape_colored = done_tape.colorDistance(color.BROWN) </code>
<p></p>
<code> only_tape = done_tape - tape_colored</code>
<p></p>
<code> is_done_color = only_tape.meanColor()</code>

<p> With this data in hand, we can simply run the same manipulations to get the mean color of the image which shows the dial in the "on" position. Once we have this, we can compare any input image's mean color to the mean colors of the "on" and "off" images and see which it is closer to. </p>

<p> However, this still didn't fully solve my issue as I needed some method for the program to actually tell me if the dryery had finished. Therefore, I decided to have it text me when it was done.</p>

<p> To do this, I used Python's Simple Mail Transfer Protocol library to set up a TCP connection which gmail's outgoing SMTP server. Once this was established, I could simply use Verizon's SMS gateway to send myself texts from the Gmail server. </p>

<p> I really recommend playing around with the OpenCV library and seeing what neat things you can do with it. Machine vision is an interesting subject with many, many use cases for fun weekend projects. </p>

<p> <b>Notes: </b><p>
<ul>
	<li><p>For the rough script, see: <a href="https://github.com/edschembor/Blog-Resources"> Blog Resources </a></p></li>
	<li><p>I'm using OpenCV version 2.4.9.</p></li>
	<li><p>Not sure how sensitive this is to lighthing - want to do some more experimenting</p></li>
	<li><p>For a straightforward script-to-SMS tutorial, see: <a href="http://alextrle.blogspot.com/2011/05/how-to-send-sms-message-with-python.html">Alex Lee's Blog</a> </p></li>
</ul>

<p> <b>OpenCV/Machine Vision Learning Materials I Recommend:</b> <p>
<ul>
	<li><p><a href="http://opencv-python-tutroals.readthedocs.org/en/latest/py_tutorials/py_video/py_bg_subtraction/py_bg_subtraction.html#background-subtraction">Video background subtraction</a></p></li>
	<li><p><a href="http://opencv-python-tutroals.readthedocs.org/en/latest/py_tutorials/py_imgproc/py_template_matching/py_template_matching.html#template-matching">Template matching in OpenCV</a></p></li>
	<li><p><a href="http://tutorial.simplecv.org/en/latest/examples/parking.html">Detecting a car in a parking lot</a></p></li>
</ul>

</div>

</body>

</html>